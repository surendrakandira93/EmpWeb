<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.12.0/moment.min.js" charset="utf-8"></script>

    <script type="text/javascript" src="https://d3js.org/d3.v3.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/cal-heatmap/3.3.10/cal-heatmap.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/cal-heatmap/3.3.10/cal-heatmap.css" />

    <style>
        .post-st ul li {
            display: inline-block;
            margin-right: 6px;
        }
    </style>
    <style>
        .q10 {
            fill: rgb(50,205,47);
        }

        .q9 {
            fill: rgb(109, 214,106);
        }

        .q8 {
            fill: rgb(122, 222,125);
        }

        .q7 {
            fill: rgb(154, 233,153);
        }

        .q6 {
            fill: rgb(208, 245,208);
        }

        .q5 {
            fill: rgb(245, 187, 186);
        }

        .q4 {
            fill: rgb(251, 133,131);
        }

        .q3 {
            fill: rgb(254, 89,92);
        }

        .q2 {
            fill: rgb(255, 46, 67);
        }

        .q1 {
            fill: rgb(250, 2, 2);
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="main-section">
            <div class="container">
                <div class="main-section-data">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="main-ws-sec">
                                <div class="posts-section">
                                    <div class="post-bar">
                                        <div class="post-st">
                                            <ul>
                                                <li><a href="javascript:void(0);" style="background-color:cadetblue;" class="btn btn btn-primary year-calendar" data-year="2019"><i class="fa fa-calendar"></i> 2019</a></li>
                                                <li><a href="javascript:void(0);" style="background-color:cadetblue;" class="btn btn btn-primary year-calendar" data-year="2020"><i class="fa fa-calendar"></i> 2020</a></li>
                                                <li><a href="javascript:void(0);" style="background-color:cadetblue;" class="btn btn btn-primary year-calendar" data-year="2021"><i class="fa fa-calendar"></i> 2021</a></li>
                                                <li><a href="javascript:void(0);" style="background-color:cadetblue;" class="btn btn btn-primary year-calendar" data-year="2022"><i class="fa fa-calendar"></i> 2022</a></li>
                                                <li><a href="javascript:void(0);" style="background-color:cadetblue;" class="btn btn btn-primary year-calendar" data-year="2023"><i class="fa fa-calendar"></i> 2023</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="col-md-12" style="overflow: auto; overflow: auto; background-color: white;">
                                        <div id="calendar" style="position:relative;margin-top: 55px;margin-bottom: 25px;"></div>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        </div>
        <script>
            var cal;
            $(document).ready(function () {
                $(".year-calendar").on("click", function (event) {
                    var year = parseInt($(this).data('year'));
                    cal = cal.destroy();
                    initCalendar(new Date(year, 0, 1), new Date(year, 11, 31));
                });

                initCalendar(new Date(2022, 0, 1), new Date(2022, 11, 31));
            })

            function GetData(start, end) {
                var chartData = {};
                let loop = new Date(start);
                while (loop <= end) {
                    var count = (loop.getDay() !== 0 && loop.getDay() !== 6) ? Math.floor(Math.random() * 60) : Math.floor(Math.random() * 10);
                    chartData[Math.floor(loop.getTime() / 1000)] = count;
                    let newDate = loop.setDate(loop.getDate() + 1);
                    loop = new Date(newDate);
                }
                return chartData;
            }

            var parser = function (data) {
                var stats = {};
                for (var d in data) {
                    stats[data[d].date] = data[d].value;
                }
                return stats;
            };

            

            function initCalendar(start,end) {

                var chartData = GetData(start, end);
                
                cal = new CalHeatMap();
                cal.init({
                    
                    itemSelector: "#calendar",
                    start: start,
                    domain: "month",
                    subDomain: "x_day",                
                    cellSize: 9,
                    range: 12,
                    weekStartOnMonday: true,
                    domainGutter: 10,
                    data: chartData,
                    //afterLoadData: parser,
                    //subDomainTextFormat: "%d",
                    domainLabelFormat: "%b-%Y",
                    legendHorizontalPosition: "left",
                    legendCellSize: 20,
                    legend: [5,10,15,20,25,30,35,40,45],
                    displayLegend: true,
                    considerMissingDataAsZero: true,
                    // legendColors: ["rgb(255,0,0)", "rgb(0,255,0)"],
                    legendColors: {
                       // min: "rgb(255,0,0)",
                        //max: "rgb(0,255,0)",
                        empty: "rgb(237,237,237)",
                    },
                    tooltip: true,
                    cellLabel: {
                        empty: "Aucune données pour le {date}",
                        filled: `{count} {name} at {date}`
                    }
                });
            }

        </script>
</body>
</html>